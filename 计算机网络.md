##  计算机网络

基于小林图解+面试题进行整理

##  HTTP

###  HTTP基本概念

在**两点**之间传输超文本的协议，既可以从客户端传到服务器，也可以从服务器传到服务器

###  HTTP常见状态码

1xx 表示目前是协议处理的中间状态

2xx 成功

- 200 OK 表示成功
- 204 No Content 与200OK基本相同，但是响应头没有HEAD数据
- 206 Partial Content 用于分块下载/断点续传

3xx 重定向

- 301 永久重定向
- 302 临时重定向 301和302会在响应头里使用字段Location指明后续要跳转的页面URL，浏览器会自动进行跳转
- 304 缓存重定向 表示资源未修改，重定向已经存在的缓冲文件

4xx 客户端有误

- 400 粗略的错误
- 403 FORBIDDEN 服务器拒绝访问
- 404 NOT FOUND 找不到所请求的资源

5xx 服务器有误

- 500 粗略的错误
- 501 客户端请求的功能还不支持
- 502 服务器自身出现错误
- 503 服务器当前很忙

##  HTTP常见字段

1. Host

   客户端发送请求时，指定服务器的域名

2. Connection

   客户端确定是否要开长连接，长连接时，只要一端没有明确表示要断开连接，就保持TCP连接状态

 3. Content-Length 服务器返回数据时携带的字段，表明当前返回的数据长度，作为HTTP body的边界

    HTTP协议通过设置回车符，换行符作为HTTP header的边界，Content-Length字段作为HTTP body的边界，目的：**为了解决粘包的问题**

 4. Content-Type 服务器回应时告诉客户端本次数据的格式

 5. Content-Encoding 表明服务器返回的数据使用的压缩格式

 6. Accept-Encoding 客户端告诉服务器，可以接受哪些压缩方法

##  GET和POST区别

###  语义

GET是从服务器获取指定的资源

POST是会根据请求的报文对指定的资源做出处理



GET是安全且幂等的，所以可以对GET请求进行缓存

POST不安全且不幂等，也可以有URL查询参数



什么是安全：就是不会改变服务器上的资源

什么是幂等：就是多次执行相同的操作，结果都是相同的

##  HTTP缓存

###  强缓存

只要浏览器判断缓存没有过期，就可以直接使用浏览器的本地缓存，决定是否缓存的主动性在于浏览器

相关的字段 HTTP响应头

- Cache-Control 相对时间，优先级高于Expires，选项更多更精细
- Expires 是一个绝对时间



强缓存流程：

- 当浏览器第一次访问服务器资源时，服务器会在响应头加上Cache-Control，这个里面设置了过期的时间大小

- 浏览器再次访问该服务器中的资源时，会通过请求资源的时间与Cache-Control中设置的时间比较，判断是否过期，如果过期，就会重新请求，并且返回的新的响应会加上新的Cache-Control。

  如果没有过期，就会直接使用该缓存

###  协商缓存

是与服务端进行协商后，根据结果判断是否使用本地缓存

实现方式：

1. 请求头： If-Modified-Since

   响应头： Last-Modified

2. 请求头：If-None-Match

   响应头Etag

ETag的优先级更高

1. 在没有修改文件内容的情况下文件最后修改时间也可能会被改变
2. 有些文件在秒级以内修改，If-Modified-Since只能检查到秒级的文件
3. 有些服务器不能精确获取文件的最后修改时间

协商缓存都需要配合Cache-Control字段进行使用，只有在未命中强制缓存的时候，才能发起协商缓存的请求

![img](https://cdn.xiaolincoding.com/gh/xiaolincoder/network/http/http%E7%BC%93%E5%AD%98.png)